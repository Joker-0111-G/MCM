clear;clc
% A为子序列与母序列矩阵，最后一列为母序列
A=[0.9141 0.9444 0.8200 0.9100 0.8900 0.8200 0.9444 
0.8629 1.0000 0.7900 0.8600 0.9100 0.8400 1.0000 
0.1992 1.0000 0.8300 0.6800 0.7200 0.8800 1.0000 
0.2403 1.0000 0.7600 0.8200 0.8600 0.7600 1.0000 
0.0588 1.0000 0.7800 0.8800 0.9400 0.7200 1.0000 
0.4020 0.3444 0.6300 0.6700 0.6300 0.5600 0.6700 
0.1832 1.0000 0.7400 0.7100 0.7800 0.7000 1.0000 
0.2135 0.9444 0.7100 0.7600 0.8500 0.6900 0.9444 
0.1501 1.0000 0.6600 0.7300 0.6500 0.6700 1.0000 
0.1729 1.0000 0.7200 0.7200 0.7600 0.7400 1.0000 
0.0784 1.0000 0.6900 0.8700 0.9300 0.6800 1.0000 
0.2109 1.0000 0.6700 0.6700 0.6600 0.8800 1.0000 
0.2262 0.9333 0.7600 0.8600 0.8700 0.6000 0.9333 
0.0588 1.0000 0.6600 0.7200 0.7400 0.7200 1.0000 
0.0441 1.0000 0.6900 0.6700 0.7000 0.7800 1.0000 
0.5905 1.0000 0.6800 0.7400 0.6900 0.6400 1.0000 
0.1191 1.0000 0.6300 0.6300 0.7100 0.6800 1.0000 
0.3922 0.9556 0.6800 0.7200 0.7500 0.7700 0.9556 
0.0588 1.0000 0.6700 0.7200 0.7900 0.6300 1.0000 
0.3186 1.0000 0.7600 0.7300 0.6800 0.8000 1.0000 
0.4902 1.0000 0.6600 0.6900 0.6600 0.8900 1.0000 
0.3336 1.0000 0.7600 0.8600 0.8300 0.7500 1.0000 
0.2895 0.8333 0.7200 0.7400 0.6400 0.6900 0.8333 
0.1852 1.0000 0.6900 0.8100 0.9200 0.7700 1.0000 
0.2318 1.0000 0.7400 0.6900 0.7700 0.6000 1.0000 
0.0588 1.0000 0.6900 0.8400 0.8800 0.7600 1.0000 
0.3453 0.4333 0.6400 0.7300 0.6200 0.6500 0.7300 
0.4567 0.0000 0.6900 0.7100 0.6000 0.6400 0.7100 
];
B=[0.2816 0.9067 0.7114 0.7550 0.7654 0.7254 0.9543 
];
C=zeros(28,7);
for i=1:28
for j=1:7
C(i,j)=A(i,j)/B(j);
end
end
% 得到灰色关联度实验数据预处理矩阵C


D=zeros(26,6);
for i=1:28
for j=1:6
D(i,j)=abs(C(i,j)-C(i,7));
end
end
% 计算两极最大最小极差
a=min(min(D));
b=max(max(D));

% 取分辨系数
p=0.5;

% 定义伽马函数矩阵
gama=zeros(28,6);

% 进行数据计算

for i=1:28
for j=1:6
gama(i,j)=(a+p*b)/(D(i,j)+p*b);
end
end

% 得灰色关联度r
r=sum(gama)/28;
%则各项指标的权重为w
w=r/sum(r);
% 构造初始灵敏度数值矩阵
w1=w-0.01*ones(1,6);
w0=repmat(w1,5,1);
for i=2:5
for j=1:6
w0(i,j)=w0(i,j)+0.05*(i-1);
end
end
figure;
hold on;

for t=1:5



% 正向化矩阵E
E=[0.9141 0.9444 0.8200 0.9100 0.8900 0.8200 
0.8629 1.0000 0.7900 0.8600 0.9100 0.8400 
0.1992 1.0000 0.8300 0.6800 0.7200 0.8800 
0.2403 1.0000 0.7600 0.8200 0.8600 0.7600 
0.0588 1.0000 0.7800 0.8800 0.9400 0.7200 
0.4020 0.3444 0.6300 0.6700 0.6300 0.5600 
0.1832 1.0000 0.7400 0.7100 0.7800 0.7000 
0.2135 0.9444 0.7100 0.7600 0.8500 0.6900 
0.1501 1.0000 0.6600 0.7300 0.6500 0.6700 
0.1729 1.0000 0.7200 0.7200 0.7600 0.7400 
0.0784 1.0000 0.6900 0.8700 0.9300 0.6800 
0.2109 1.0000 0.6700 0.6700 0.6600 0.8800 
0.2262 0.9333 0.7600 0.8600 0.8700 0.6000 
0.0588 1.0000 0.6600 0.7200 0.7400 0.7200 
0.0441 1.0000 0.6900 0.6700 0.7000 0.7800 
0.5905 1.0000 0.6800 0.7400 0.6900 0.6400 
0.1191 1.0000 0.6300 0.6300 0.7100 0.6800 
0.3922 0.9556 0.6800 0.7200 0.7500 0.7700 
0.0588 1.0000 0.6700 0.7200 0.7900 0.6300 
0.3186 1.0000 0.7600 0.7300 0.6800 0.8000 
0.4902 1.0000 0.6600 0.6900 0.6600 0.8900 
0.3336 1.0000 0.7600 0.8600 0.8300 0.7500 
0.2895 0.8333 0.7200 0.7400 0.6400 0.6900 
0.1852 1.0000 0.6900 0.8100 0.9200 0.7700 
0.2318 1.0000 0.7400 0.6900 0.7700 0.6000 
0.0588 1.0000 0.6900 0.8400 0.8800 0.7600 
0.3453 0.4333 0.6400 0.7300 0.6200 0.6500 
0.4567 0.0000 0.6900 0.7100 0.6000 0.6400 
];

% 标准化矩阵H
H=zeros(28,6);

h=zeros(1,6);

for j=1:6
for i=1:28
h(j)=E(i,j)*E(i,j)+h(j); 
end
end

for i=1:28
for j=1:6
H(i,j)=E(i,j)/h(j);
end
end

% 定义最值向量和最值距离矩阵
D_max=max(H);
D_min=min(H);

Z_max=H-repmat(D_max,[28,1]);
Z_min=H-repmat(D_min,[28,1]);


% 算距离
sum_max=zeros(28,1);
sum_min=zeros(28,1);

for i=1:28
for j=1:6
sum_max(i)=w0(t,j)*Z_max(i,j)*Z_max(i,j);
sum_min(i)=w0(t,j)*Z_min(i,j)*Z_min(i,j);
end
end


d_max=sqrt(sum_max);
d_min=sqrt(sum_min);

d_=d_max+d_min;
s=d_min/d_;
s=s(:,1);
s=s/sum(s);


x=1:28;
y=s';


plot(x, y);


% 添加标题和轴标签
title('Sensitivity Analysis');
xlabel('Order Of Each Project');
ylabel('Normalized Score');




end


